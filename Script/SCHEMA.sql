/* ---------------------------------------------------- */
/*  Generated by Enterprise Architect Version 15.2 		*/
/*  Created On : 03-Jul-2021 9:07:20 AM 				*/
/*  DBMS       : Oracle 						*/
/* ---------------------------------------------------- */

/* Drop Tables */

begin
	EXECUTE IMMEDIATE 'DROP TABLE   BenhNhan CASCADE CONSTRAINTS';
	EXCEPTION WHEN OTHERS THEN NULL;
end;
/

begin
	EXECUTE IMMEDIATE 'DROP TABLE   ChamCong CASCADE CONSTRAINTS';
	EXCEPTION WHEN OTHERS THEN NULL;
end;
/

begin
	EXECUTE IMMEDIATE 'DROP TABLE   ChiTietDonThuoc CASCADE CONSTRAINTS';
	EXCEPTION WHEN OTHERS THEN NULL;
end;
/

begin
	EXECUTE IMMEDIATE 'DROP TABLE   DichVu CASCADE CONSTRAINTS';
	EXCEPTION WHEN OTHERS THEN NULL;
end;
/

begin
	EXECUTE IMMEDIATE 'DROP TABLE   HoaDon_DichVu CASCADE CONSTRAINTS';
	EXCEPTION WHEN OTHERS THEN NULL;
end;
/

begin
	EXECUTE IMMEDIATE 'DROP TABLE   HoaDon_Thuoc CASCADE CONSTRAINTS';
	EXCEPTION WHEN OTHERS THEN NULL;
end;
/

begin
	EXECUTE IMMEDIATE 'DROP TABLE   LichTruc CASCADE CONSTRAINTS';
	EXCEPTION WHEN OTHERS THEN NULL;
end;
/

begin
	EXECUTE IMMEDIATE 'DROP TABLE   NhanVien CASCADE CONSTRAINTS';
	EXCEPTION WHEN OTHERS THEN NULL;
end;
/

begin
	EXECUTE IMMEDIATE 'DROP TABLE   PhieuKhamBenh CASCADE CONSTRAINTS';
	EXCEPTION WHEN OTHERS THEN NULL;
end;
/

begin
	EXECUTE IMMEDIATE 'DROP TABLE   PhieuXetNghiem CASCADE CONSTRAINTS';
	EXCEPTION WHEN OTHERS THEN NULL;
end;
/

begin
	EXECUTE IMMEDIATE 'DROP TABLE   Phong CASCADE CONSTRAINTS';
	EXCEPTION WHEN OTHERS THEN NULL;
end;
/

begin
	EXECUTE IMMEDIATE 'DROP TABLE   Thuoc CASCADE CONSTRAINTS';
	EXCEPTION WHEN OTHERS THEN NULL;
end;
/

/* Create Tables */

CREATE TABLE  BenhNhan
(
	BN_MABN CHAR(8) NOT NULL,
	BN_HOTEN VARCHAR2(50) NOT NULL,
	BN_NGAYSINH DATE NOT NULL,
	BN_DIACHI VARCHAR2(50) NOT NULL,
	BN_SDT CHAR(10) NOT NULL,
	BN_NGAYLAPHOSO DATE NOT NULL
)
;

CREATE TABLE  ChamCong
(
	CC_MANV CHAR(8) NOT NULL,
	CC_THOIGIAN DATE NOT NULL,
	CC_SONGAYNGHI NUMBER(4) NOT NULL,
	CC_LUONGTRU NUMBER(10) NULL,
	CC_LUONGTHUONG NUMBER(10) NULL,
	CC_TONGLUONG NUMBER(10) NULL,
	CC_GHICHU VARCHAR2(50) NULL
)
;

CREATE TABLE  ChiTietDonThuoc
(
	DT_MADON CHAR(8) NOT NULL,
	DT_MATHUOC CHAR(8) NOT NULL,
	DT_SOLUONG NUMBER(3) NOT NULL,
	DT_GHICHU VARCHAR2(50) NULL
)
;

CREATE TABLE  DichVu
(
	DV_MADV CHAR(8) NOT NULL,
	DV_TENDV VARCHAR2(30) NOT NULL,
	DV_PHIDV NUMBER(10) NOT NULL,
	DV_MOTA VARCHAR2(50) NULL,
	DV_MAPHONG CHAR(4) NOT NULL
)
;

CREATE TABLE  HoaDon_DichVu
(
	HDDV_MAPHIEU CHAR(8) NOT NULL,
	HDDV_TONGTIEN NUMBER(10) NOT NULL,
	HDDV_NGAYLAPHD DATE NOT NULL
)
;

CREATE TABLE  HoaDon_Thuoc
(
	HDT_MAPHIEU CHAR(8) NOT NULL,
	HDT_TONGTIEN NUMBER(10) NOT NULL,
	HDT_NGAYLAPHD DATE NOT NULL
)
;

CREATE TABLE  LichTruc
(
	LT_MABS CHAR(8) NOT NULL,
	LT_MAPHONG CHAR(4) NOT NULL,
	LT_THOIGIANBATDAU TIMESTAMP NOT NULL,
	LT_THOIGIANKETTHUC TIMESTAMP NOT NULL
)
;

CREATE TABLE  NhanVien
(
	NV_MANV CHAR(8) NOT NULL,
	NV_PASSWORD CHAR(20) NOT NULL,
	NV_HOTEN VARCHAR2(50) NOT NULL,
	NV_NGAYSINH DATE NOT NULL,
	NV_SDT CHAR(10) NOT NULL,
	NV_LUONGCB NUMBER(10) NOT NULL,
	NV_PHUCAP NUMBER(10) NULL,
	NV_CHUCVU VARCHAR2(20) NOT NULL,
    NV_ACTIVE CHAR(1) NOT NULL
)
;

CREATE TABLE  PhieuKhamBenh
(
	P_MAPHIEUKHAM CHAR(8) NOT NULL,
	P_NGAYKHAM DATE NOT NULL,
	P_TRIEUCHUNG VARCHAR2(50) NOT NULL,
	P_PHIKHAM NUMBER(10) NOT NULL,
	P_KETLUAN VARCHAR2(2048) NOT NULL,
	P_MABN CHAR(8) NOT NULL,
	P_MABS CHAR(8) NOT NULL
)
;

CREATE TABLE  PhieuXetNghiem
(
	PXN_MAPHIEU CHAR(8) NOT NULL,
	PXN_MADV CHAR(8) NOT NULL,
	PXN_KETQUA VARCHAR2(50) NOT NULL
)
;

CREATE TABLE  Phong
(
	PHG_MAPHONG CHAR(4) NOT NULL,
	PHG_LOAIPHONG VARCHAR2(20) NOT NULL
)
;

CREATE TABLE  Thuoc
(
	T_MATHUOC CHAR(8) NOT NULL,
	T_TENTHUOC VARCHAR2(30) NOT NULL,
	T_DONGIA NUMBER(8) NOT NULL,
	T_CONGDUNG VARCHAR2(50) NULL,
	T_GHICHU VARCHAR2(50) NULL
)
;

/* Create Primary Keys, Indexes, Uniques, Checks, Triggers */

ALTER TABLE  BenhNhan 
 ADD CONSTRAINT PK_BenhNhan
	PRIMARY KEY (BN_MABN) 
 USING INDEX
;

ALTER TABLE  ChamCong 
 ADD CONSTRAINT PK_ChamCong
	PRIMARY KEY (CC_MANV,CC_THOIGIAN) 
 USING INDEX
;

CREATE INDEX IXFK_ChamCong_NhanVien  
 ON  ChamCong (CC_MANV) 
;

ALTER TABLE  ChiTietDonThuoc 
 ADD CONSTRAINT PK_DonThuoc
	PRIMARY KEY (DT_MATHUOC,DT_MADON) 
 USING INDEX
;


CREATE INDEX IXFK_CHITIETHD_THUOC   
 ON  ChiTietDonThuoc (DT_MADON) 
;

CREATE INDEX IXFK_ChiTietDonThuoc_Thuoc   
 ON  ChiTietDonThuoc (DT_MATHUOC) 
;

ALTER TABLE  DichVu 
 ADD CONSTRAINT PK_DichVu
	PRIMARY KEY (DV_MADV) 
 USING INDEX
;

CREATE INDEX IXFK_DichVu_Phong   
 ON  DichVu (DV_MAPHONG) 
;

ALTER TABLE  HoaDon_DichVu 
 ADD CONSTRAINT PK_HoaDon_DichVu
	PRIMARY KEY (HDDV_MAPHIEU) 
 USING INDEX
;

ALTER TABLE  HoaDon_Thuoc 
 ADD CONSTRAINT PK_HoaDon_Thuoc
	PRIMARY KEY (HDT_MAPHIEU) 
 USING INDEX
;

ALTER TABLE  LichTruc 
 ADD CONSTRAINT PK_LichTruc
	PRIMARY KEY (LT_MABS,LT_THOIGIANBATDAU,LT_MAPHONG) 
 USING INDEX
;

CREATE INDEX IXFK_LichTruc_NhanVien
 ON  LichTruc (LT_MABS) 
;

CREATE INDEX IXFK_LichTruc_Phong  
 ON  LichTruc (LT_MAPHONG) 
;

ALTER TABLE  NhanVien 
 ADD CONSTRAINT PK_NhanVien
	PRIMARY KEY (NV_MANV) 
 USING INDEX
;

ALTER TABLE  PhieuKhamBenh 
 ADD CONSTRAINT PK_PhieuKhamBenh
	PRIMARY KEY (P_MAPHIEUKHAM) 
 USING INDEX
;

CREATE INDEX IXFK_PhieuKhamBenh_BenhNhan  
 ON  PhieuKhamBenh (P_MABN) 
;

CREATE INDEX IXFK_PhieuKhamBenh_NhanVien 
 ON  PhieuKhamBenh (P_MABS) 
;

ALTER TABLE  PhieuXetNghiem 
 ADD CONSTRAINT PK_PhieuXetNghiem
	PRIMARY KEY (PXN_MAPHIEU,PXN_MADV) 
 USING INDEX
;

CREATE INDEX IXFK_CHITIETHD_DICHVU   
 ON  PhieuXetNghiem (PXN_MAPHIEU) 
;

CREATE INDEX IXFK_PhieuXetNghiem_DichVu  
 ON  PhieuXetNghiem (PXN_MADV) 
;

ALTER TABLE  Phong 
 ADD CONSTRAINT PK_Phong
	PRIMARY KEY (PHG_MAPHONG) 
 USING INDEX
;

ALTER TABLE  Thuoc 
 ADD CONSTRAINT PK_Thuoc
	PRIMARY KEY (T_MATHUOC) 
 USING INDEX
;

/* Create Foreign Key Constraints */

ALTER TABLE  ChamCong 
 ADD CONSTRAINT FK_ChamCong_NhanVien
	FOREIGN KEY (CC_MANV) REFERENCES  NhanVien (NV_MANV)
;

ALTER TABLE  ChiTietDonThuoc 
 ADD CONSTRAINT FK_DT_HOADON
	FOREIGN KEY (DT_MADON) REFERENCES  HoaDon_Thuoc (HDT_MAPHIEU)
;

ALTER TABLE  ChiTietDonThuoc 
 ADD CONSTRAINT FK_DT_THUOC
	FOREIGN KEY (DT_MATHUOC) REFERENCES  Thuoc (T_MATHUOC)
;

ALTER TABLE  DichVu 
 ADD CONSTRAINT FK_DichVu_Phong
	FOREIGN KEY (DV_MAPHONG) REFERENCES  Phong (PHG_MAPHONG)
;

ALTER TABLE  HoaDon_DichVu 
 ADD CONSTRAINT FK_HDDV_PHIEUKHAM
	FOREIGN KEY (HDDV_MAPHIEU) REFERENCES  PhieuKhamBenh (P_MAPHIEUKHAM)
;

ALTER TABLE  HoaDon_Thuoc 
 ADD CONSTRAINT FK_HDT_PHIEUKHAM
	FOREIGN KEY (HDT_MAPHIEU) REFERENCES  PhieuKhamBenh (P_MAPHIEUKHAM)
;

ALTER TABLE  LichTruc 
 ADD CONSTRAINT FK_LichTruc_NhanVien
	FOREIGN KEY (LT_MABS) REFERENCES  NhanVien (NV_MANV)
;

ALTER TABLE  LichTruc 
 ADD CONSTRAINT FK_LichTruc_Phong
	FOREIGN KEY (LT_MAPHONG) REFERENCES  Phong (PHG_MAPHONG)
;

ALTER TABLE  PhieuKhamBenh 
 ADD CONSTRAINT FK_PhieuKhamBenh_BenhNhan
	FOREIGN KEY (P_MABN) REFERENCES  BenhNhan (BN_MABN)
;

ALTER TABLE  PhieuKhamBenh 
 ADD CONSTRAINT FK_PhieuKhamBenh_NhanVien
	FOREIGN KEY (P_MABS) REFERENCES  NhanVien (NV_MANV)
;

ALTER TABLE  PhieuXetNghiem 
 ADD CONSTRAINT FK_PXN_DICHVU
	FOREIGN KEY (PXN_MADV) REFERENCES  DichVu (DV_MADV)
;

ALTER TABLE  PhieuXetNghiem 
 ADD CONSTRAINT FK_PXN_HOADON
	FOREIGN KEY (PXN_MAPHIEU) REFERENCES  HoaDon_DichVu (HDDV_MAPHIEU)
;

